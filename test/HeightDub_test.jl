using DataFrames #is this needed here?
using Base.Test

import @HeightDub

datapath = joinpath(@__DIR__, "..", "data")
df=readtable(joinpath(datapath, "IEsubset_CSV.csv"))

#cd("$(pwd())/test/data") #for local testing, remove later
#df=readtable("IEsubset_Data_CSV.csv")

# 2 parameter Wyckoff coefficients. Default values for IE variant of FVS
FVS_IE=Dict{String,Array{Float64}}(
"WP"=>[5.19988	-9.26718],
"WL"=>[4.97407	-6.78347],
"DF"=>[4.81519	-7.29306],
"GF"=>[5.00233	-8.19365],
"WH"=>[4.97331	-8.19730],
"RC"=>[4.89564	-8.39057],
"LP"=>[4.62171	-5.32481],
"ES"=>[4.9219	-8.30289],
"AF"=>[4.76537	-7.61062],
"PP"=>[4.9288	-9.32795],
"MH"=>[4.77951	-9.31743],
"WB"=>[4.97407	-6.78347],
"LM"=>[4.19200	-5.16510],
"LL"=>[4.76537	-7.61062],
"PI"=>[3.20000	-5.00000],
"RM"=>[3.20000	-5.00000],
"PY"=>[4.19200	-5.16510],
"AS"=>[4.44210	-6.54050],
"CO"=>[4.44210	-6.54050],
"MM"=>[4.44210	-6.54050],
"PB"=>[4.44210	-6.54050],
"OH"=>[4.44210	-6.54050],
"OS"=>[4.77951	-9.31743] )

wyckoff_test=[
4.51200508834407
4.51288647292418
4.52051997701690
4.51990688337836
4.51258570729445
4.51248732100628
4.50059900153411
4.51401238362169
4.51224667618840
4.51219850929630
4.51231281942515
4.52061084982230
4.52233556834551
4.52007969660945
4.51236584777014
4.51990858956966
4.51219040526744
4.51254775727212
4.51991355221878
4.51295345464577
4.50059900153411
4.50059900153411
4.51983480610115
4.51987505287998
4.51191296035336
4.51247924773007
4.51200508834407
4.51192801164185
4.52005389024830
4.52080020992967
4.52075307942579
4.52090163989736
4.52005389024830
4.52038063854719]

user_eq_test=[
5.50000110437066
5.50000077727861
5.50000025616043
5.50000027222188
5.50000085504705
5.50000088557174
5.49997579696978
5.50000059480051
5.50000097615539
5.50000099792679
5.50000094851992
5.50002825335774
5.50002185801763
5.50003169790446
5.50000092800344
5.50003314012292
5.50000100174185
5.50000086646161
5.50003309510479
5.50000076242647
5.49997579696978
5.49997579696978
5.50003383536612
5.50003344996446
5.50000117082406
5.50000088821741
5.50000110437066
5.50000115899896
5.50003190202163
5.50002728005371
5.50002751279364
5.50002679851972
5.50003190202163
5.50002959423972]


@testset HeightDub_tests begin
    @test_approx_eq @HeightDub(Wyckoff,FVS_IE,df,:Species,:DBH) â‰ˆ
    @test user_eq=UserDefHD("4.5+x^b[1]^b[2]") == (x,b)->4.5+x^b[1]^b[2]
    @HeightDub(user_eq,FVS_IE,df,:Species,:DBH) ==
end
